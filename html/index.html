<html>
	<head>
		<meta charset="utf-8">
		<script src="../js/topojson.js"></script>
		<script src="../js/d3.min.js"></script> 
		<script src="../js/datamaps.all.js"></script>
		<script src="../js/jquery-2.1.4.min.js"></script>
		<script src="../js/jquery-2.1.4.min.js"></script>
		<script src="../js/jquery-2.1.4.min.js"></script>
		<script src="../js/bootstrap.min.js"></script>
		<link href="../css/bootstrap.css" rel="stylesheet">
		<script>

		function parseResponse(data) { 
				console.log(data.data);				
			};
			// function getJSONP(url, success) {
			//     var ud = '_' + +new Date,
   //      		script = document.createElement('script'),
   //      		head = document.getElementsByTagName('head')[0] || document.documentElement;

 		// 	   window[ud] = function(data) {
   //      			head.removeChild(script);
   //      			success && success(data);
   //  			}
   //  			script.src = url;
   //  			// script.src = url.replace('callback=?', 'callback=' + ud);
   //  			head.appendChild(script);
			// };
			// for(i = 1; i < 700; i++) {
			// 	var urlToCall = 'https://www.smokereports.com/api/v1.0/strains?page=' + i + '&callback=parseResponse';
			// 	getJSONP(urlToCall, function(data) {
	  //   			console.log(data);
			// 	});
			// }

				// <script type='application/javascript' src="https://www.smokereports.com/api/v1.0/strains?page=" + i + "?callback=parseResponse"/>
			
		</script>

		
		<script>
			$(document).ready(function() {
				navigator.geolocation.getCurrentPosition(showPosition);
				function showPosition(position){
				    console.log("Latitude: " + position.coords.latitude); 
				    console.log(" Longitude: " + position.coords.longitude);
				};
				document.getElementById("cannabisMap").onmouseover = function() {
					console.log("ENTRO")
					if(document.getElementById("cannabisMap").children[1].children[0].children[1].innerHTML == "Posesión: Despenalizado") {
					 	document.getElementById("cannabisMap").children[1].children[0].children[1].innerHTML.style.color='green';
					}
				};
				$("body").delegate("#possesionText","myCustomEvent",function() {
					console.log("AHSDSADKLSAS")
					document.getElementById("cannabisMap").children[1].children[0].children[1].innerHTML.style.color='green';
				});
				$("#cannabisMap").click(function() {
  					$("#possesionText").trigger("myCustomEvent");
				});
				function colorLabels() {
					if(document.getElementById("possesionText").innerHTML == "Posesión: Despenalizado") {
					 	document.getElementById("possesionText").style.color='green';
					}
				};
			});
		</script>
	</head>
	<body>
		<div class="container-fluid">
		    <div class="row">
		        <div class="col-md-9">
		        	<div id="cannabisMap" style="height: 100%">
		        	</div>
		        </div>
		       	<div id="rightTable" class="col-md-3">
		            <div>
		            	<h1>BARRA</h1>
		            </div>
		        </div>
		    </div>
		</div>
		<!-- <div id="cannabisMap" style="position: relative; height: 640px; width: 1000px"></div> -->
		<script>
		 	var series = [
		 					// Afganistán
			 				["AFG",4.3,"Sin información","Sin información","Sin información","Sin información"],
			 				// Albania
			 				["ALB",1.8,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Tierras Australes y Antárticas Francesas
			 				["ATF",0.0],
			 				// Argelia
			 				["DZA",5.7,"Ilegal","Ilegal","Ilegal","Ilegal"],
							// Angola
			 				["AGO",2.1,"Sin información","Sin información","Sin información","Sin información"],
			 				// Argentina
			 				["ARG",7.2,"Despenalizado","Ilegal","Ilegal","Ilegal"],
			 				// Armenia
			 				["ARM",3.5,"Sin información","Sin información","Sin información","Sin información"],
			 				// Antártida
			 				["ATA",0.0],
			 				// Australia
			 				["AUS",10.6,"Despenalizado","Ilegal","Ilegal","Despenalizado"],
			 				// Austria
			 				["AUT",3.5,"Despenalizado","Ilegal","Ilegal","Ilegal"],
			 				// Azerbaiyán
			 				["AZE",3.5,"Sin información","Sin información","Sin información","Sin información"],
			 				// Bahamas
			 				["BHS",5.5,"Sin información","Sin información","Sin información","Sin información"],
			 				// Bangladesh
			 				["BGD",3.3,"Sin información","Sin información","Sin información","Sin información"],
			 				// Bielorrusia
			 				["BLR",1.1,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Burundi
			 				["BDI",0.0],
			 				// Bélgica
			 				["BEL",5.1,"Despenalizado","Ilegal","Ilegal","Despenalizado"],
			 				// Belice
			 				["BLZ",8.5,"Despenalizado","Ilegal","Ilegal","Ilegal"],
			 				// Bolivia
			 				["BOL",4.3,"Despenalizado","Ilegal","Ilegal","Ilegal"],
			 				// Bután
			 				["BTN",0.0],
			 				// Botsuana
			 				["BWA",0.0,"Despenalizado","Ilegal","Ilegal","Ilegal"],
			 				// Bosnia y Herzegovina
			 				["BIH",2.8,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Brasil
			 				["BRA",2.6,"Ilegal","Ilegal","Ilegal","Despenalizado"],
			 				// Benín
			 				["BEN",0.0],
			 				// Brunéi
			 				["BRN",0.02,"Sin información","Sin información","Sin información","Sin información"],
			 				// Bulgaria
			 				["BGR",2.5,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Burkina Faso
			 				["BFA",2.9,"Sin información","Sin información","Sin información","Sin información"],
			 				// Camboya
			 				["KHM",3.5,"Despenalizado","Despenalizado","Despenalizado","Despenalizado"],
			 				// República Centroafricana
			 				["CAF",0.0],
			 				// Canadá
			 				["CAN",12.6,"Despenalizado","Despenalizado","Ilegal","Despenalizado"],
			 				// Camerún
			 				["CMR",0.0],
			 				// Chad
			 				["TCD",0.9,"Sin información","Sin información","Sin información","Sin información"],
			 				// Chile
			 				["CHL",11.3,"Despenalizado","Despenalizado","Ilegal","Legal"],
			 				// China
			 				["CHN",0.0,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Colombia
			 				["COL",2.3,"Legal","Ilegal","Ilegal","Legal"],
			 				// Costa Rica
			 				["CRI",1.0,"Despenalizado","Ilegal","Ilegal","Despenalizado"],
			 				// Cuba
			 				["CUB",0.0],
			 				// Croacia
			 				["HRV",5.2,"Despenalizado","Despenalizado","Ilegal","Ilegal"],
			 				// Chipre
			 				["CYP",4.4,"Despenalizado","Ilegal","Ilegal","Despenalizado"],
			 				// Costa de Marfil
			 				["CIV",0.0],
			 				// República Checa
			 				["CZE",15.2,"Despenalizado","Despenalizado","Despenalizado","Despenalizado"],
			 				// Dinamarca
			 				["DNK",5.5,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// República Dominicana
			 				["DOM",0.3],
							// Ecuador
			 				["ECU",0.7,"Despenalizado","Ilegal","Ilegal","Ilegal"],
			 				// Egipto
			 				["EGY",6.2,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// El Salvador
			 				["SLV",0.4],
			 				// Eritrea
			 				["ERI",0.0],
			 				// Gabón
			 				["GAB",0.0],
			 				// Gran Bretaña
			 				["GBR",6.6,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Estonia
			 				["EST",6.0,"Despenalizado","Ilegal","Ilegal","Ilegal"],
			 				// Etiopía
			 				["ETH",2.6,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Fiji
			 				["FJI",5.1],
			 				// Finlandia
			 				["FIN",3.1,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Francia
			 				["FRA",8.6,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Georgia
			 				["GEO",2.7],
			 				// Alemania
			 				["DEU",4.8,"Despenalizado","Despenalizado","Despenalizado","Despenalizado"],
			 				// Gambia
			 				["GMB",0.0],
			 				// Ghana
			 				["GHA",21.5],
			 				// Grecia
			 				["GRC",1.7,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Groenlandia
			 				["GRL",7.6,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Guatemala
			 				["GTM",4.8],
			 				// Guinea
			 				["GIN",0.0],
			 				// Guinea-Bisáu
			 				["GNB",0.0],
			 				// Guinea Ecuatorial
			 				["GNQ",0.0],
			 				// Guyana Francesa
			 				["GUF",0.0],
			 				// Guyana
			 				["GUY",2.6],
			 				// Haití
			 				["HTI",1.4],
			 				// Honduras
			 				["HND",0.8,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Hungría
			 				["HUN",2.3,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Islandia
			 				["ISL",3.4,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// India
			 				["IND",3.2,"Despenalizado","Despenalizado","Despenalizado","Despenalizado"],
			 				// Indonesia
			 				["IDN",0.4,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Irán
			 				["IRN",4.2],
			 				// Irlanda
			 				["IRL",6.3,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Israel
			 				["ISR",8.9,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Italia
			 				["ITA",14.6,"Despenalizado","Ilegal","Ilegal","Ilegal"],
			 				// Irak
			 				["IRQ",0.0],
			 				// Jamaica
			 				["JAM",9.9,"Despenalizado","Ilegal","Ilegal","Legal"],
			 				// Japón
			 				["JPN",0.1,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Jordania
			 				["JOR",2.1,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Kazajistán
			 				["KAZ",4.2],
			 				// Kenia
			 				["KEN",2.1],
			 				// Kosovo
			 				["KSV",0.0],
			 				// Kuwait
			 				["KWT",3.1],
			 				// Kirguistán
			 				["KGZ",6.4],
			 				// Laos
			 				["LAO",0.9,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Lesoto
			 				["LSO",0.0],
			 				// Letonia
			 				["LVA",4.9,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Líbano
			 				["LBN",1.9,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Libia
			 				["LBY",0.05],
			 				// Liberia
			 				["LBR",0.0],
			 				// Lituania
			 				["LTU",5.6,"Despenalizado","Ilegal","Ilegal","Ilegal"],
			 				// Luxemburgo
			 				["LUX",7.6,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Macedonia
			 				["MKD",0.6,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Madagascar
			 				["MDG",9.1],
			 				// Malasia
			 				["MYS",1.6,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Malaui
			 				["MWI",0.0],
			 				// Malí
			 				["MLI",7.8],
			 				// Mauritania
			 				["MRT",0.0],
			 				// México
			 				["MEX",1.2,"Despenalizado","Ilegal","Ilegal","Despenalizado"],
			 				// Moldavia
			 				["MDA",0.9],
			 				// Mongolia
			 				["MNG",0.0],
			 				// Montenegro
			 				["MNE",0.2,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Mozambique
			 				["MOZ",0.0],
			 				// Marruecos
			 				["MAR",4.2],
			 				// Birmania
			 				["MMR",0.9],
			 				// Namibia
			 				["NAM",3.9],
			 				// Nepal
			 				["NPL",3.2,"Despenalizado","Ilegal","Ilegal","Ilegal"],
			 				// Níger
			 				["NER",0.0],
			 				// Holanda
			 				["NLD",5.4,"Legal","Despenalizado","Despenalizado","Despenalizado"],
			 				// Nueva Caledonia
			 				["NCL",1.9],
			 				// Nueva Zelanda
			 				["NZL",14.6,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Nicaragua
			 				["NIC",1.1],
			 				// Nigeria
			 				["NGA",14.3],
			 				// Noruega
			 				["NOR",4.6,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Omán
			 				["OMN",0.1],
			 				// Pakistán
			 				["PAK",3.9,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Panamá
			 				["PAN",3.6,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Papúa Nueva Guinea
			 				["PNG",29.5],
			 				// Corea del Norte
			 				["PRK",0.0,"Legal","Legal","Legal","Legal"],
			 				// Paraguay
			 				["PRY",1.6,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Perú
			 				["PER",0.7,"Despenalizado","Ilegal","Ilegal","Ilegal"],
			 				// Filipinas
			 				["PHL",0.8,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Polonia
			 				["POL",2.7,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Portugal
			 				["PRT",3.3,"Despenalizado","Ilegal","Despenalizado","Despenalizado"],
			 				// Puerto Rico
			 				["PRI",4.9,"Despenalizado","Despenalizado","Despenalizado","Despenalizado"],
			 				// Cisjordania
			 				["PSE",0.0],
			 				// Qatar
			 				["QAT",0.1],
			 				// Corea del Sur
			 				["KOR",0.3,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// República Democrática del Congo
			 				["COD",0.0],
			 				// República del Congo
			 				["COG",0.0],
			 				// República Turca del Norte de Chipre
			 				["CNP",0.0],
			 				// Ruanda
			 				["RWA",0.0],
			 				// Rumania
			 				["ROU",0.4,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Rusia
			 				["RUS",3.5,"Despenalizado","Ilegal","Despenalizado","Despenalizado"],
			 				// Arabia Saudita
			 				["SAU",0.3,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Senegal
			 				["SEN",2.8],
			 				// Serbia
			 				["SRB",4.1,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Sierra Leona
			 				["SLE",16.1],
			 				// Sudán
			 				["SDN",0.0],
			 				// Sudán del Sur
			 				["SSD",0.0],
			 				// Eslovaquia
			 				["SVK",6.9,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Eslovenia
			 				["SVN",4.1,"Despenalizado","Ilegal","Ilegal","Despenalizado"],
			 				// Sahara
			 				["ESH",0.0],
			 				// Somalia
			 				["SOM",2.5,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Suazilandia
			 				["SWZ",0.0],
			 				// Sudáfrica
			 				["ZAF",4.3,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// España
			 				["ESP",10.6,"Legal","Ilegal","Despenalizado","Legal"],
			 				// Sri Lanka
			 				["LKA",1.5,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Somalilandia
			 				["SML",0.0],
			 				// Islas Salomón
			 				["SLB",0.0],
			 				// Surinam
			 				["SUR",4.3],
			 				// Suecia
			 				["SWE",1.2,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Suiza
			 				["CHE",3.4,"Despenalizado","Ilegal","Ilegal","Ilegal"],
			 				// Siria
			 				["SYR",2.0,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Taiwán
			 				["TWN",0.3,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Tayikistán
			 				["TJK",3.4],
			 				// Turkmenistán
			 				["TKM",0.0],
			 				// Timor Oriental
			 				["TLS",0.0],
			 				// Tanzania
			 				["TZA",0.2],
			 				// Tailandia
			 				["THA",1.2,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Togo
			 				["TGO",1.0],
			 				// Trinidad y Tobago
			 				["TTO",4.7],
			 				// Túnez
			 				["TUN",0.0,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Turquía
			 				["TUR",1.9,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 				// Uganda
			 				["UGA",1.4],
			 				// Ucrania
			 				["UKR",2.5,"Despenalizado","Ilegal","Despenalizado","Despenalizado"],
			 				// Emiratos Árabes Unidos
			 				["ARE",5.4,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 		 		// Uruguay
			 		 		["URY",6.0,"Legal","Legal","Legal","Legal"],
			 		 		// Estados Unidos
			 		 		["USA",13.7,"Despenalizado","Despenalizado","Despenalizado","Despenalizado"],
			 		 		// Uzbekistán
			 		 		["UZB",4.2,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 		 		// Vanuatu
			 		 		["VUT",0.1],
			 		 		// Venezuela
			 		 		["VEN",0.9,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 		 		// Vietnam
			 		 		["VNM",0.3,"Ilegal","Ilegal","Ilegal","Ilegal"],
			 		 		// Yemen
			 		 		["YEM",0.0],
			 		 		// Yibuti
			 		 		["DJI",0.0],
			 				// Zambia
			 				["ZMB",9.5],
			 				// Zimbabue
			 				["ZWE",6.9,"Ilegal","Ilegal","Ilegal","Ilegal"]
			 			];

			var dataset = {};
			var onlyValues = series.map(function(obj){ return obj[1]; });
    		var minValue = Math.min.apply(null, onlyValues), maxValue = Math.max.apply(null, onlyValues);

    		var paletteScale = d3.scale.linear().domain([minValue,maxValue]).range(["#EFEFFF","#02386F"]); 

    		series.forEach(function(item) { 
				var iso = item[0],
				value = item[1];
				possesion = item[2];
				sale = item[3];
				transport = item[4];
				cultivation = item[5];
				dataset[iso] = { numberOfThings: value, fillColor: paletteScale(value), possesion, sale, transport, cultivation};
			});

			var cannabisMap = new Datamap({
				element: document.getElementById("cannabisMap"),
			  	projection: 'mercator',
			  	fills: {
			    	'authorHasTraveledTo': '#fa0fa0',
			    	defaultFill: 'gray'
			  	},
			  	geographyConfig: {
			  		highlightBorderColor: '#000000',
			   		popupTemplate: function(geography, data) {
			      		return '<div class="hoverinfo">' + '<p style="font-family: Helvetica Neue, Helvetica, Arial, sans-serif; font-size: 13px; font-weight: bold;margin-bottom: 0px; margin-top: 0px; text-align: center">'  + geography.properties.name + '</p>' + '<p id="possesionText" style="font-family: Helvetica Neue, Helvetica, Arial, sans-serif; font-size: 10px; margin-bottom: 0px; margin-top: 0px; text-align: left">Posesión: ' +  data.possesion + ' </p>' + '<p style="font-family: Helvetica Neue, Helvetica, Arial, sans-serif; font-size: 10px; margin-bottom: 0px; margin-top: 0px; text-align: left">Venta: ' +  data.sale + ' </p>' + '<p style="font-family: Helvetica Neue, Helvetica, Arial, sans-serif; font-size: 10px; margin-bottom: 0px; margin-top: 0px; text-align: left">Transporte: ' +  data.transport + ' </p>' + '<p style="font-family: Helvetica Neue, Helvetica, Arial, sans-serif; font-size: 10px; margin-bottom: 0px; margin-top: 0px; text-align: left">Cultivación: ' +  data.cultivation + ' </p>'
			    	},
			    	highlightFillColor: function(geo) {
		            	return geo['fillColor'];
		            },
			    	highlightBorderWidth: 2
			  	},
			  	data: dataset,
			  // 		// Falkland islands ver que hacemos FLK
			});

			//cannabisMap.labels();
			var colors = d3.scale.category10();
		</script>
	</body>
</html>